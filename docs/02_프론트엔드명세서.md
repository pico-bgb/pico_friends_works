# PICOFriends Frontend 명세서 (Next.js)

## 1. 기술 스택
- **Framework**: Next.js 14+ (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS / CSS Modules
- **State Management**: React Context API / Zustand
- **HTTP Client**: Axios / Fetch API
- **Form Management**: React Hook Form
- **Validation**: Zod / Yup
- **UI Components**: Headless UI / shadcn/ui

## 2. 프로젝트 구조
```
frontend/
├── app/
│   ├── (auth)/
│   │   ├── login/
│   │   │   └── page.tsx
│   │   └── register/
│   │       └── page.tsx
│   ├── dashboard/
│   │   ├── layout.tsx
│   │   └── page.tsx
│   ├── company/
│   │   ├── page.tsx
│   │   └── [id]/
│   │       └── page.tsx
│   ├── pharmacy/
│   │   ├── page.tsx
│   │   └── [id]/
│   │       └── page.tsx
│   ├── work-distribution/
│   │   └── page.tsx
│   ├── notice/
│   │   ├── page.tsx
│   │   └── [id]/
│   │       └── page.tsx
│   ├── layout.tsx
│   └── page.tsx
├── components/
│   ├── auth/
│   │   ├── LoginForm.tsx
│   │   └── RegisterForm.tsx
│   ├── dashboard/
│   │   ├── DashboardHeader.tsx
│   │   └── Navigation.tsx
│   ├── company/
│   │   ├── CompanyList.tsx
│   │   ├── CompanyCard.tsx
│   │   └── CompanyModal.tsx
│   ├── pharmacy/
│   │   ├── PharmacyList.tsx
│   │   ├── PharmacyCard.tsx
│   │   ├── PharmacyModal.tsx
│   │   └── PharmacyCsvUpload.tsx
│   ├── work/
│   │   ├── WorkList.tsx
│   │   ├── WorkCard.tsx
│   │   └── WorkDistributionModal.tsx
│   ├── notice/
│   │   ├── NoticeList.tsx
│   │   └── NoticeEditor.tsx
│   ├── common/
│   │   ├── Button.tsx
│   │   ├── Input.tsx
│   │   ├── Select.tsx
│   │   ├── Modal.tsx
│   │   ├── Calendar.tsx
│   │   ├── Pagination.tsx
│   │   └── SearchFilter.tsx
│   └── layout/
│       ├── Header.tsx
│       ├── Footer.tsx
│       └── Sidebar.tsx
├── lib/
│   ├── api/
│   │   ├── auth.ts
│   │   ├── company.ts
│   │   ├── pharmacy.ts
│   │   ├── work.ts
│   │   └── notice.ts
│   ├── hooks/
│   │   ├── useAuth.ts
│   │   ├── useCompany.ts
│   │   ├── usePharmacy.ts
│   │   ├── useWork.ts
│   │   └── useNotice.ts
│   ├── utils/
│   │   ├── validation.ts
│   │   ├── format.ts
│   │   └── csvParser.ts
│   └── types/
│       ├── auth.ts
│       ├── company.ts
│       ├── pharmacy.ts
│       ├── work.ts
│       └── notice.ts
├── contexts/
│   └── AuthContext.tsx
├── middleware.ts
└── next.config.js
```

## 3. 화면별 상세 명세

### 3.1 로그인 (PF-010)
**경로**: `/login`

**기능**:
- 이메일 주소 입력
- 비밀번호 입력
- 로그인 버튼
- 회원가입 링크

**컴포넌트**: `LoginForm.tsx`
```typescript
interface LoginFormData {
  email: string;
  password: string;
}
```

**Validation**:
- 이메일 형식 검증
- 비밀번호 필수 입력

### 3.2 회원가입 (PF-010)
**경로**: `/register`

**기능**:
- 이메일 주소 입력
- 비밀번호 입력
- 이름 입력
- 전화번호 입력 (format: 010-1234-5678)
- 소속학교 선택 (드롭다운, 37개 학교)
- 회원가입 버튼
- 로그인 링크

**컴포넌트**: `RegisterForm.tsx`
```typescript
interface RegisterFormData {
  email: string;
  password: string;
  name: string;
  phoneNumber: string;
  university: string;
}
```

**Validation**:
- 이메일 중복 체크
- 비밀번호 강도 검증
- 전화번호 형식 검증 (010-1234-5678)
- 모든 필드 필수 입력

### 3.3 배정된 업무 (PF-020)
**경로**: `/dashboard`

**기능**:
1. **배정된 업무가 없는 경우**
   - 메시지 표시: "배정된 업무가 없습니다. 업무 배정을 요청해주세요."
   - 로그아웃 버튼

2. **로그인 후 회원 화면**
   - 업무 리스트 표시
   - 로그인 사용자 표시
   - 각 업무 카드 클릭 시 상세보기 모달

**컴포넌트**: `WorkList.tsx`, `WorkCard.tsx`
```typescript
interface Work {
  id: number;
  title: string;
  description: string;
  assignedUsers: User[];
  pharmacy: Pharmacy;
  status: 'pending' | 'in_progress' | 'completed';
  createdAt: string;
  updatedAt: string;
}
```

### 3.4 미이미지 출력 후 회원 (PF-020)
**경로**: `/dashboard` (미이미지 조회 후)

**기능**:
- 대시보드 기능
  - 오늘 방문약국 수, 회원가입 약국 수 표시
  - 데이터는 약국 방문, 회원가입 기준으로 막대 그래프 표기

- 이미지 기능
  - 관리자가 지정한 이미지를 노출

- 랭킹보드 기능
  - 대표 피코프렌즈 오늘의 랭킹 1위 ~ 10위 확인
  - O월 O주차 전체 랭킹은 해당 주차의 일요일 자녀 6시 데이터 기준으로 랭킹 순위가 정해짐
  - 동점자가 있을 경우 가장 먼저 기록한 사람이 위쪽

- 하단 데이터 위치 기능을 텍스트로 고치한다

**컴포넌트**: `DashboardStats.tsx`, `RankingBoard.tsx`
```typescript
interface DashboardStats {
  todayPharmacyVisits: number;
  todayRegistrations: number;
  weeklyPharmacyVisits: number;
  weeklyRegistrations: number;
}

interface Ranking {
  rank: number;
  userName: string;
  universityId: string;
  score: number;
  recordedAt: string;
}
```

### 3.5 검색 필터 (PF-020)
**기능**:
- **Select Box**: 첫 번째 항목은 기본값 또는 선택값으로 문구 표시
  - 선택 옵션이 5개 이상일 경우 스크롤 바를 이용하여 세공

- **Calendar**: 날짜 입력 형식은 YYYY.MM.DD
  - 기본 현재 날짜, 달력 칼럼은 이중선 / 다음 월로 이동하는 방식 제공

- **Text Box**: 텍스트 입력 시 텍스트는 좌측 정렬, Placeholder 제공

- **Button**: 버튼명은 기본대로 정렬, 기능의 우측 정렬

### 3.6 배정된 약국 (PF-020)
**경로**: `/pharmacy/assigned`

**기능**:
1. **발문 인증 (클릭 시)**
   - 발문 인증이 완료되지 않았을 때 배정된 약국 목록이 나타남
   - 발문 인증이 완료되었다면 클릭이 비활성화 되고 버튼 클릭이 가능하게 나타남
   - 배정된 약국 리스트를 확인 할 수 있게 대응페이지로 넘어가는 기능

2. **페이징 기능**: 10개씩 기준으로 출력
   - 맨 처음으로: 버튼 클릭 시 페이지 번호 이에제로지 1 페이지로 이동
   - 이전: 10 페이지 단위로 이전으로 이동 (예: 15페이지에서 이전 버튼 클릭 시 1 페이지로 이동)
   - 다음: 10 페이지 단위로 다음으로 이동 (예: 5페이지에서 다음 버튼 클릭 시 11 페이지로 이동)

3. **설문 조사**
   - 관리자에서 지정한 외부 링크로 사진이 설정될 구글 설문조사로 이동 함

4. **설문 조사**
   - 설문조사 버튼 까지 클릭하면 자동 배정 구글 설문조사로 이동 함

5. **방문 완료 처리**
   - 설문조사 버튼 까지 클릭하면 자동 배정 1차 체크하고, 실제 약국을 회원 가입 완료를 1차 체크 한 뒤 추가 고정

**컴포넌트**: `AssignedPharmacyList.tsx`

### 3.7 배정된 약국 - 리포트 기능 (PF-020)
**기능**:
- 구글 설문에 등록된 액셀 파일의 약국 정보를 불러올 수 있음
- 데이터는 약국 방문, 회원가입 기준으로 막대 그래프 표기
- 전체 전환율 표기

**컴포넌트**: `PharmacyReport.tsx`

### 3.8 메뉴 (특이사항)
**기능**:
- 리포트 기능: 약국 기본 정보
  - 약국 기본 정보: 약사님 성함, 약사님 연락처

- 약국 운영 및 예약 사항:
  - 온라인을 이용 현황
  - 주력 판매 상품군
  - 가장 시급하게 필요한 제품 또는 서비스
  - 마케팅 / 홍보 관련 고민

- 피코프렌즈 반응:
  - 피코를 해본 안내 후 반응

- 현장활동 요약 및 다음 단계 계획:
  - 피코프렌즈 방문 (필수)
  - 현장활동 요약 및 다음 단계 계획 (필수) (텍스트 입력)

## 4. 백오피스 화면

### 4.1 대시보드 (백오피스 홈)
**경로**: `/admin`

**기능**:
- 관리자 로그인 후 홈 화면
- 피코프렌즈 전체 대상 오늘 약국 방문, 오늘 회원 가입 데이터 표기
- 피코프렌즈 전체 인원 통계 그래프
  - 데이터는 약국 방문, 회원가입 기준으로 막대 그래프 표기
  - 그래프 범용으로 표기하고, 일자, 주차, 월별 조회로 표기
  - 전체 전환율 표기
  - 프렌즈별 활동 순위

**컴포넌트**: `AdminDashboard.tsx`

### 4.2 사용자 관리
**경로**: `/admin/users`

**기능**:
- 초건부 검색 필터
  - 역할: 전체보기, 관리자, 피코프렌즈
  - 상태: 전체보기, 승인대기, 승인완료, 승인거부

- 디폴트 자동: 전체
- 필터 사용시 나타나는 데이블

- CSV 다운로드
- 사용자 회원 가입 승인 / 거부
  - 버튼 형태로 승인 / 거부 선택 시 승인/거부함 (소인만 승인하면 승인 완료)

- 추정 (관리자가 접속하여 사용자 정보 수정)
  - 상태 (사용자 정보 상세)

- 관리자 코멘트 작성

**컴포넌트**: `UserManagement.tsx`

### 4.3 약국 관리
**경로**: `/admin/pharmacies`

**기능**:
- 새 약국 추가 시
  - 데이블의 정보를 입력하여 등록

- CSV 가져오기
  - CSV 작성상 파일로 시스템에 등록
  - CSV 내보내기
    - 등록된 약국 리스트는 내보내기

- 약국 정보 수정 및 삭제
  - 데이블의 정보를 수정 및 삭제

- 구글 설문 데이터 물러오기 가능할 때 해당 약국에 대한 데이터를 확인 할 수 있음 (구글 설문 데이터 물러오기 물가능할 때) 각 약국의 리포트를 확인 할 수 있고, 클릭 시 개별만 목록 처럼 나타남니다. (리 알베시오 수 있음 - 약국 리스트를 도터시)

**컴포넌트**: `PharmacyManagement.tsx`

### 4.4 업무 분배
**경로**: `/admin/work-distribution`

**기능**:
- 초건부 검색 필터
  - 이름, 지역 (시 / 도 / 동 표기), 약국명, 피코프렌즈
  - 방문, 회원가입, 검색

- 디폴트 자동: 전체
- 필터 사용시 나타나는 데이블
- 비고의 경우
  - 구글 설문 데이터 물러오기 가능할 때 해당 약국에 대한 데이터를 확인 할 수 있음

- 달성률 = 회원가입 수 / 총 배정 수
- 검색 결과를 CSV 형태로 다운로드
- 내역의 맞을 경우 다음 페이지로 이동

**컴포넌트**: `WorkDistribution.tsx`

### 4.5 공지 관리
**경로**: `/admin/notices`

**기능**:
- 공지 관리 클릭 시 해당 내용 상세보기 화면으로 이동
  - 리스트 수: 10개
  - 노출항목: 번호 / 제목 / 작성일 / 작성자
  - 리스트 노출 수서: 최신 등록순으로 노출

- 본문 내 이미지 존재 시 카메라 아이콘 노출

- 버튼 클릭 시 공지 작성 3-1로 이동 (기본 개선판 컴포넌트 사용)

**컴포넌트**: `NoticeManagement.tsx`

**공지 작성 / 수정 화면**:
- 카테고리
- 작성자
- 제목
- 내용 (리치 텍스트 에디터)
  - 글꼴 관리
  - 제목 / 부제목
  - 내용 리치 텍스트 에디터 포함

**컴포넌트**: `NoticeEditor.tsx`

## 5. 공통 컴포넌트

### 5.1 Button
```typescript
interface ButtonProps {
  variant: 'primary' | 'secondary' | 'danger' | 'ghost';
  size: 'sm' | 'md' | 'lg';
  disabled?: boolean;
  loading?: boolean;
  children: React.ReactNode;
  onClick?: () => void;
}
```

### 5.2 Modal
```typescript
interface ModalProps {
  isOpen: boolean;
  onClose: () => void;
  title: string;
  children: React.ReactNode;
  size?: 'sm' | 'md' | 'lg' | 'xl';
}
```

### 5.3 Calendar
```typescript
interface CalendarProps {
  value: Date;
  onChange: (date: Date) => void;
  format?: string; // default: 'YYYY.MM.DD'
  minDate?: Date;
  maxDate?: Date;
}
```

### 5.4 Pagination
```typescript
interface PaginationProps {
  currentPage: number;
  totalPages: number;
  onPageChange: (page: number) => void;
  pageSize?: number; // default: 10
}
```

### 5.5 SearchFilter
```typescript
interface SearchFilterProps {
  filters: FilterConfig[];
  onFilterChange: (filters: FilterValues) => void;
}

interface FilterConfig {
  name: string;
  type: 'select' | 'text' | 'date' | 'dateRange';
  placeholder?: string;
  options?: { label: string; value: string }[];
}
```

## 6. 상태 관리

### 6.1 Auth Context
```typescript
interface AuthContextType {
  user: User | null;
  isAuthenticated: boolean;
  isLoading: boolean;
  login: (email: string, password: string) => Promise<void>;
  register: (data: RegisterFormData) => Promise<void>;
  logout: () => void;
}
```

## 7. API 연동

### 7.1 인증 API
```typescript
// lib/api/auth.ts
export const authApi = {
  login: (email: string, password: string) => axios.post('/api/auth/login', { email, password }),
  register: (data: RegisterFormData) => axios.post('/api/auth/register', data),
  logout: () => axios.post('/api/auth/logout'),
  getProfile: () => axios.get('/api/auth/profile'),
};
```

### 7.2 업무 API
```typescript
// lib/api/work.ts
export const workApi = {
  getAssignedWorks: () => axios.get('/api/works/assigned'),
  getWorkDetail: (id: number) => axios.get(`/api/works/${id}`),
  updateWorkStatus: (id: number, status: string) => axios.patch(`/api/works/${id}/status`, { status }),
};
```

### 7.3 약국 API
```typescript
// lib/api/pharmacy.ts
export const pharmacyApi = {
  getPharmacies: (params?: PharmacyQueryParams) => axios.get('/api/pharmacies', { params }),
  getPharmacyDetail: (id: number) => axios.get(`/api/pharmacies/${id}`),
  createPharmacy: (data: PharmacyFormData) => axios.post('/api/pharmacies', data),
  updatePharmacy: (id: number, data: PharmacyFormData) => axios.put(`/api/pharmacies/${id}`, data),
  deletePharmacy: (id: number) => axios.delete(`/api/pharmacies/${id}`),
  uploadCsv: (file: File) => axios.post('/api/pharmacies/csv/upload', formData),
  downloadCsv: () => axios.get('/api/pharmacies/csv/download'),
};
```

## 8. 라우팅 및 미들웨어

### 8.1 Protected Routes
```typescript
// middleware.ts
export function middleware(request: NextRequest) {
  const token = request.cookies.get('token');

  if (!token && request.nextUrl.pathname.startsWith('/dashboard')) {
    return NextResponse.redirect(new URL('/login', request.url));
  }

  if (token && request.nextUrl.pathname.startsWith('/admin')) {
    // Check admin role
    // ...
  }
}

export const config = {
  matcher: ['/dashboard/:path*', '/admin/:path*'],
};
```

## 9. 환경 변수
```env
NEXT_PUBLIC_API_BASE_URL=http://localhost:8080/api
NEXT_PUBLIC_APP_NAME=PICOFriends
```

## 10. 개발 가이드라인

### 10.1 코드 스타일
- TypeScript strict mode 사용
- ESLint + Prettier 설정
- 컴포넌트명: PascalCase
- 파일명: PascalCase (컴포넌트), camelCase (유틸)

### 10.2 성능 최적화
- 이미지 최적화: Next.js Image 컴포넌트 사용
- 코드 스플리팅: 동적 import 사용
- 메모이제이션: React.memo, useMemo, useCallback 활용

### 10.3 접근성
- ARIA 속성 적절히 사용
- 키보드 네비게이션 지원
- 시맨틱 HTML 태그 사용
